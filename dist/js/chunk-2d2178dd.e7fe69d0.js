(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2178dd"],{c6e9:function(t,o,a){"use strict";a.r(o);var n=function(){var t=this,o=t.$createElement,a=t._self._c||o;return a("div",[a("loading",{attrs:{active:t.isLoading},on:{"update:active":function(o){t.isLoading=o}}}),a("div",{staticClass:"checkorder"},[a("h1",[t._v("Shopping Cart")]),a("table",{staticClass:"checkorder_table"},[t._m(0),a("tbody",t._l(t.cart,(function(o){return a("tr",{key:o.id},[a("td",{staticClass:"order"},[a("div",{staticClass:"order"},[a("div",{staticClass:"order-img"},[a("img",{attrs:{src:o.product.imageUrl[0],alt:""}})]),a("div",{staticClass:"order-title"},[a("router-link",{attrs:{to:"/"}},[t._v(t._s(o.product.title))])],1)])]),a("td",[a("span",[t._v("數量")]),a("div",{staticClass:"checkorder_table_quantity"},[a("select",{directives:[{name:"model",rawName:"v-model",value:o.quantity,expression:"item.quantity"}],on:{change:[function(a){var n=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var o="_value"in t?t._value:t.value;return o}));t.$set(o,"quantity",a.target.multiple?n:n[0])},function(a){return t.updateCart(o.product.id,o.quantity)}]}},[a("option",{attrs:{value:"1"}},[t._v("1")]),a("option",{attrs:{value:"2"}},[t._v("2")]),a("option",{attrs:{value:"3"}},[t._v("3")]),a("option",{attrs:{value:"4"}},[t._v("4")]),a("option",{attrs:{value:"5"}},[t._v("5")]),a("option",{attrs:{value:"6"}},[t._v("6")]),a("option",{attrs:{value:"7"}},[t._v("7")]),a("option",{attrs:{value:"8"}},[t._v("8")]),a("option",{attrs:{value:"9"}},[t._v("9")]),a("option",{attrs:{value:"10"}},[t._v("10")])])])]),a("td",[a("span",[t._v("單價")]),t._v(" "+t._s(t._f("money")(o.product.price))+" ")]),a("td",[a("span",[t._v("小計")]),t._v(" "+t._s(t._f("money")(o.product.price*o.quantity))+" ")]),a("td",[a("span",[t._v("刪除")]),a("button",{staticClass:"checkorder_table_remove",attrs:{type:"button"},on:{click:function(a){return t.removeCartItem(o.product.id)}}},[a("i",{staticClass:"far fa-trash-alt"})])])])})),0)]),a("div",{staticClass:"checkorder_coupon"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.coupon_code,expression:"coupon_code"}],attrs:{type:"text",name:"coupon",placeholder:"Enter discount code"},domProps:{value:t.coupon_code},on:{input:function(o){o.target.composing||(t.coupon_code=o.target.value)}}}),a("button",{attrs:{type:"submit"},on:{click:t.addCoupon}},[t._v("Apply")])]),a("div",{staticClass:"checkorder_total"},[a("ul",[a("li",[a("span",[t._v("Subtotal")]),a("span",[t._v(t._s(t._f("money")(t.subtotal)))])]),a("li",[a("span",[t._v("Shipping")]),a("span",[t._v(t._s(t._f("money")(t.shipping)))])]),a("li",[a("span",[t._v("Discount")]),t.discount>0?a("span",[t._v("-"+t._s(t._f("money")(t.discount)))]):a("span",[t._v(t._s(t._f("money")(t.discount)))])]),a("li",[a("span",[t._v("Total")]),a("span",[t._v(t._s(t._f("money")(t.subtotal+t.shipping-t.discount)))])])])]),a("div",{staticClass:"checkorder_btn"},[a("router-link",{staticClass:"checkorder_btn_back",attrs:{to:"/"}},[a("button",{attrs:{type:"button"}},[t._v("« Back to Shopping")])]),a("router-link",{staticClass:"checkorder_btn_next",attrs:{to:"/orderinfo"}},[a("button",{attrs:{type:"button"}},[t._v("Order »")])])],1)])],1)},e=[function(){var t=this,o=t.$createElement,a=t._self._c||o;return a("thead",[a("tr",[a("th",{attrs:{width:"50%"}},[t._v("商品資訊")]),a("th",[t._v("數量")]),a("th",[t._v("單價")]),a("th",[t._v("小計")]),a("th",[t._v("刪除")])])])}],i=(a("99af"),a("4160"),a("159b"),{data:function(){return{isLoading:!1,cart:[],subtotal:0,shipping:60,discount:0,coupon:{},coupon_code:""}},methods:{getCart:function(){var t=this;this.isLoading=!0,this.axios.get("".concat("https://course-ec-api.hexschool.io","/api/").concat("8e167757-8b00-4955-b28e-9494996b792d","/ec/shopping")).then((function(o){t.isLoading=!1,t.cart=o.data.data,t.subtotal=0,t.cart.forEach((function(o){t.subtotal+=o.product.price*o.quantity}))})).catch((function(o){t.isLoading=!1,console.log(o)}))},updateCart:function(t,o){var a=this;this.isLoading=!0;var n="".concat("https://course-ec-api.hexschool.io","/api/").concat("8e167757-8b00-4955-b28e-9494996b792d","/ec/shopping"),e={product:t,quantity:o};this.axios.patch(n,e).then((function(){a.getCart(),a.isLoading=!1})).catch((function(t){a.isLoading=!1,console.log(t)}))},removeCartItem:function(t){var o=this;this.isLoading=!0;var a="".concat("https://course-ec-api.hexschool.io","/api/").concat("8e167757-8b00-4955-b28e-9494996b792d","/ec/shopping/").concat(t);this.axios.delete(a).then((function(){o.isLoading=!1,o.getCart()})).catch((function(t){o.isLoading=!1,console.log(t)}))},addCoupon:function(){var t=this;this.isLoading=!0;var o="".concat("https://course-ec-api.hexschool.io","/api/").concat("8e167757-8b00-4955-b28e-9494996b792d","/ec/coupon/search"),a={code:this.coupon_code};this.axios.post(o,a).then((function(o){t.coupon=o.data.data,t.discount=Math.floor(t.subtotal*t.coupon.percent/100),t.$bus.$emit("checkcoupon",t.coupon),t.isLoading=!1})).catch((function(o){console.log(o.response.data.errors),t.isLoading=!1}))}},created:function(){this.getCart()}}),s=i,c=a("2877"),r=Object(c["a"])(s,n,e,!1,null,null,null);o["default"]=r.exports}}]);
//# sourceMappingURL=chunk-2d2178dd.e7fe69d0.js.map